# fastQcount
Calculates stats from fastq files with automatic quality format inference.

## Commandline
```bash
usage: fastQcout.py [-h] [-infile [INFILE [INFILE ...]]] [-infiles [INFILES]]
                    [-fmt [{illumina13,illumina15,illumina18,sanger,solexa}]]
                    [-partial]

Calculates stats from fastq files with automatic quality format inference

optional arguments:
  -h, --help            show this help message and exit
  -infile [INFILE [INFILE ...]]
                        input file. can be used several times
  -infiles [INFILES]    comma separated list of files
  -fmt [{illumina13,illumina15,illumina18,sanger,solexa}]
                        format: illumina13, illumina15, illumina18, sanger,
                        solexa. Default: auto
  -partial              print partial values
```

## Accepts file name or stdin
```bash
fastQcout.py input.fastq
fastQcout.py input.fastq.gz
cat input.fastq | fastQcout.py
gunzip -ck | fastQcout.py
```

## If using stdin and fastq is compressed, using parallel uncompressor is advised
```bash
pigz -ck | fastQcout.py
```

## to save report to a file
```bash
fastQcout.py input.fastq | tee report.txt
```

## pypy
pypy can speed up the analysis up to 10x
```
        pypy 2.2.1 python 2.7.6
real    0m47.082s  4m28.306s
user    0m44.425s  4m25.372s
sys     0m02.580s  0m2.432s
```


## Output
```bash
# seqs  :     1028866636
# bases :   102886663600
Quals: 66, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105
min  :  66
max  : 105
inference 3
OUR BEST GUESS IS 'illumina15'
format: illumina15
 '!'    [ 33]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '"'    [ 34]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '#'    [ 35]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '$'    [ 36]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '%'    [ 37]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '&'    [ 38]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 "'"    [ 39]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '('    [ 40]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 ')'    [ 41]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '*'    [ 42]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '+'    [ 43]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 ','    [ 44]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '-'    [ 45]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '.'    [ 46]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '/'    [ 47]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '0'    [ 48]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '1'    [ 49]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '2'    [ 50]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '3'    [ 51]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '4'    [ 52]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '5'    [ 53]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '6'    [ 54]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '7'    [ 55]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '8'    [ 56]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '9'    [ 57]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 ':'    [ 58]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 ';'    [ 59]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '<'    [ 60]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '='    [ 61]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '>'    [ 62]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '?'    [ 63]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 '@'    [ 64]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 'A'    [ 65]:              0 (  0.000% |   0.000% | 100.000%) Q     Phred         [                                                  ]
 'B'    [ 66]:  1,547,772,964 (  1.504% |   1.504% |  98.496%) Q     Phred         [*                                                 ]
 'C'    [ 67]:              0 (  0.000% |   1.504% |  98.496%) Q   3 Phred 0.50119 [                                                  ]
 'D'    [ 68]:              0 (  0.000% |   1.504% |  98.496%) Q   4 Phred 0.39811 [                                                  ]
 'E'    [ 69]:      9,462,604 (  0.009% |   1.514% |  98.486%) Q   5 Phred 0.31623 [                                                  ]
 'F'    [ 70]:     32,874,563 (  0.032% |   1.545% |  98.455%) Q   6 Phred 0.25119 [                                                  ]
 'G'    [ 71]:    212,016,807 (  0.206% |   1.752% |  98.248%) Q   7 Phred 0.19953 [                                                  ]
 'H'    [ 72]:    254,813,347 (  0.248% |   1.999% |  98.001%) Q   8 Phred 0.15849 [                                                  ]
 'I'    [ 73]:    152,945,688 (  0.149% |   2.148% |  97.852%) Q   9 Phred 0.12589 [                                                  ]
 'J'    [ 74]:    127,301,285 (  0.124% |   2.272% |  97.728%) Q  10 Phred 0.10000 [                                                  ]
 'K'    [ 75]:     69,831,035 (  0.068% |   2.339% |  97.661%) Q  11 Phred 0.07943 [                                                  ]
 'L'    [ 76]:     34,818,059 (  0.034% |   2.373% |  97.627%) Q  12 Phred 0.06310 [                                                  ]
 'M'    [ 77]:    124,129,888 (  0.121% |   2.494% |  97.506%) Q  13 Phred 0.05012 [                                                  ]
 'N'    [ 78]:     48,885,069 (  0.048% |   2.541% |  97.459%) Q  14 Phred 0.03981 [                                                  ]
 'O'    [ 79]:     95,271,674 (  0.093% |   2.634% |  97.366%) Q  15 Phred 0.03162 [                                                  ]
 'P'    [ 80]:    111,568,536 (  0.108% |   2.743% |  97.257%) Q  16 Phred 0.02512 [                                                  ]
 'Q'    [ 81]:    113,431,867 (  0.110% |   2.853% |  97.147%) Q  17 Phred 0.01995 [                                                  ]
 'R'    [ 82]:    324,566,274 (  0.315% |   3.168% |  96.832%) Q  18 Phred 0.01585 [                                                  ]
 'S'    [ 83]:    227,402,701 (  0.221% |   3.389% |  96.611%) Q  19 Phred 0.01259 [                                                  ]
 'T'    [ 84]:    228,680,032 (  0.222% |   3.612% |  96.388%) Q  20 Phred 0.01000 [                                                  ]
 'U'    [ 85]:    140,068,797 (  0.136% |   3.748% |  96.252%) Q  21 Phred 0.00794 [                                                  ]
 'V'    [ 86]:    278,114,421 (  0.270% |   4.018% |  95.982%) Q  22 Phred 0.00631 [                                                  ]
 'W'    [ 87]:    309,434,327 (  0.301% |   4.319% |  95.681%) Q  23 Phred 0.00501 [                                                  ]
 'X'    [ 88]:    433,628,600 (  0.421% |   4.740% |  95.260%) Q  24 Phred 0.00398 [                                                  ]
 'Y'    [ 89]:    660,433,100 (  0.642% |   5.382% |  94.618%) Q  25 Phred 0.00316 [                                                  ]
 'Z'    [ 90]:  1,024,763,551 (  0.996% |   6.378% |  93.622%) Q  26 Phred 0.00251 [                                                  ]
 '['    [ 91]:    781,706,547 (  0.760% |   7.138% |  92.862%) Q  27 Phred 0.00200 [                                                  ]
 '\\'   [ 92]:    701,671,329 (  0.682% |   7.820% |  92.180%) Q  28 Phred 0.00158 [                                                  ]
 ']'    [ 93]:  1,385,793,970 (  1.347% |   9.167% |  90.833%) Q  29 Phred 0.00126 [                                                  ]
 '^'    [ 94]:  1,731,038,581 (  1.682% |  10.849% |  89.151%) Q  30 Phred 0.00100 [*                                                 ]
 '_'    [ 95]:  3,149,776,302 (  3.061% |  13.911% |  86.089%) Q  31 Phred 0.00079 [*                                                 ]
 '`'    [ 96]:  2,248,685,829 (  2.186% |  16.096% |  83.904%) Q  32 Phred 0.00063 [*                                                 ]
 'a'    [ 97]:  2,944,520,553 (  2.862% |  18.958% |  81.042%) Q  33 Phred 0.00050 [*                                                 ]
 'b'    [ 98]:  7,560,792,396 (  7.349% |  26.307% |  73.693%) Q  34 Phred 0.00040 [***                                               ]
 'c'    [ 99]:  9,205,911,568 (  8.948% |  35.254% |  64.746%) Q  35 Phred 0.00032 [****                                              ]
 'd'    [100]:  5,765,026,369 (  5.603% |  40.858% |  59.142%) Q  36 Phred 0.00025 [***                                               ]
 'e'    [101]:  9,463,872,706 (  9.198% |  50.056% |  49.944%) Q  37 Phred 0.00020 [****                                              ]
 'f'    [102]:  7,191,788,098 (  6.990% |  57.046% |  42.954%) Q  38 Phred 0.00016 [***                                               ]
 'g'    [103]: 10,792,200,601 ( 10.489% |  67.535% |  32.465%) Q  39 Phred 0.00013 [*****                                             ]
 'g'    [103]: 10,792,200,601 ( 10.489% |  67.535% |  32.465%) Q  39 Phred 0.00013 [*****                                             ]
 'h'    [104]: 12,827,088,623 ( 12.467% |  80.003% |  19.997%) Q  40 Phred 0.00010 [******                                            ]
YOUR SCALE 'illumina15' GOES BEYOND THE QUALITY SCALE. PROBABLY THE FORMAT IS WRONG.
Quals: 66, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105
min  :  66
max  : 105
inference 3
OUR BEST GUESS IS 'illumina15'
OUR BEST GUESS IS 'illumina15'
```
